<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.4 on Fri Jul 29 15:39:41 2016 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>velframe.pro (Documentation for jbiu/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="velframe.pro (Documentation for jbiu/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;    VELFRAME</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;    Converts radial velocities between Local Standard of Rest, Heliocentric and Galactocentric velocity frames.</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;    Astro</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;    Result = VELFRAME(Velocity, Longitude, Latitude)</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;    Velocity:    Scalar or vector of radial velocity to be converted, in km/s.</span>
<span class="comments">;</span>
<span class="comments">;    Longitude:   Scalar or vector of longitudinal coordinates at which the transformation is computed.</span>
<span class="comments">;                 Assumed to be decimal RA degrees unless /GALACTIC is specified, in which case it is</span>
<span class="comments">;                 decimal galactic l.</span>
<span class="comments">;</span>
<span class="comments">;    Latitude:    Scalar or vector of latitudinal coordinates at which the transformation is computed.</span>
<span class="comments">;                 Assumed to be decimal Dec degrees unless /GALACTIC is specified, in which case it is</span>
<span class="comments">;                 decimal galactic b.</span>
<span class="comments">;</span>
<span class="comments">; KEYWORD PARAMETERS:</span>
<span class="comments">;    GALACTIC: If set, input coordinates are in decimal galactic coordinates (l,b) rather than RA and Dec.</span>
<span class="comments">;</span>
<span class="comments">;    INFRAME:  Input frame. One of 'LSR', 'HELIO' or 'GSR'.</span>
<span class="comments">;</span>
<span class="comments">;    OUTFRAME: Output frame. One of 'LSR', 'HELIO' or 'GSR'.</span>
<span class="comments">;</span>
<span class="comments">;    EQUINOX:  Equinox year of Coords. Default: 2000.0.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;    Output radial velocity in desired frame, assuming no proper motion.</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;    Written by:   Jeremy Bailin</span>
<span class="comments">;    29 July 2016  Initial writing</span>
<span class="comments">;-</span>
<a id="velframe:source"></a>function velframe, velocity, longitude, latitude, galactic=galacticp, vlsr=vlsr, vhelio=vhelio, vgsr=vgsr, $
    inframe=inframe, outframe=outframe, equinox=equinox

degrad = 1./!radeg   <span class="comments">; faster to multiply than divide</span>

setdefaultvalue, equinox, 2000.0

<span class="comments">; transform coordinates to galactic</span>
if keyword_set(galacticp) then begin
    gal_l = longitude
    gal_b = latitude
endif else begin
    glactc, longitude, latitude, equinox, gal_l, gal_b, 1, /degree
endelse

<span class="comments">; velocity transformation is defined by an apex and a magnitude</span>
lsr_info = {vmag:19.7, apex_l:56.16, apex_b:22.77}
gsr_info = {vmag:232.3, apex_l:87.8, apex_b:1.7}
helio_info = {vmag:0.0, apex_l:0.0, apex_b:0.0}

case strupcase(inframe) of
    'LSR': ininfo = lsr_info
    'GSR': ininfo = gsr_info
    'HELIO': ininfo = helio_info
    else: message, 'INFRAME must be one of LSR, GSR, or HELIO.'
endcase

vshift_in = ininfo.vmag * ( sin(gal_b*degrad) * sin(ininfo.apex_b*degrad) + $
    cos(gal_b*degrad) * cos(ininfo.apex_b*degrad) * cos((gal_l-ininfo.apex_l)*degrad) )

case strupcase(outframe) of
    'LSR': outinfo = lsr_info
    'GSR': outinfo = gsr_info
    'HELIO': outinfo = helio_info
    else: message, 'OUTFRAME must be one of LSR, GSR, or HELIO.'
endcase
           
vshift_out = outinfo.vmag * ( sin(gal_b*degrad) * sin(outinfo.apex_b*degrad) + $
    cos(gal_b*degrad) * cos(outinfo.apex_b*degrad) * cos((gal_l-outinfo.apex_l)*degrad) )

return, velocity - vshift_in + vshift_out

end

</code>
    </div>
  </body>
</html>