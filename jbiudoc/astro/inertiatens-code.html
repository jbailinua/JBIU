<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.4 on Fri Jul 29 15:39:39 2016 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>inertiatens.pro (Documentation for jbiu/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="inertiatens.pro (Documentation for jbiu/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;      INERTIATENS</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;      Calculates the 2nd moment tensor (sometimes incorrectly referred to</span>
<span class="comments">;      as the moment of inertia tensor) of a mass distribution specified by</span>
<span class="comments">;      a list of particle positions.</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;      Astro</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;      Result = INERTIATENS(Pos)</span>
<span class="comments">;</span>
<span class="comments">; INPUTS:</span>
<span class="comments">;      Pos:  An Nx3 array specifying the 3d positions of the N particles</span>
<span class="comments">;            that make up the mass distribution.</span>
<span class="comments">;</span>
<span class="comments">; KEYWORD PARAMETERS:</span>
<span class="comments">;      MASSES:  An N-element vector of the mass of each point. If not</span>
<span class="comments">;               specified, all masses are assumed to be unity.</span>
<span class="comments">;</span>
<span class="comments">;      R2WEIGHT:  If /R2WEIGHT is specified then particles are downweighted</span>
<span class="comments">;                 by a factor of 1/r^2 so that all particles have equal</span>
<span class="comments">;                 effect regardless of radius.</span>
<span class="comments">;</span>
<span class="comments">; OUTPUTS:</span>
<span class="comments">;      The function returns a 3x3 symmetric array containing the 2nd moment</span>
<span class="comments">;      of the mass distribution tensor, i.e. Result[i,j] is the sum over each</span>
<span class="comments">;      particle k of MASSES[k] * Pos[k,i] * Pos[k,j].</span>
<span class="comments">;</span>
<span class="comments">; EXAMPLE:</span>
<span class="comments">;      Calculate the inertia tensor of 6 equal-mass points distributed on</span>
<span class="comments">;      the vertices of a cube:</span>
<span class="comments">;</span>
<span class="comments">;      xmasspos = [-1,-1,-1,-1,1,1,1,1]</span>
<span class="comments">;      ymasspos = [-1,-1,1,1,-1,-1,1,1]</span>
<span class="comments">;      zmasspos = [-1,1,-1,1,-1,1,-1,1]</span>
<span class="comments">;      itens = INERTIATENS([[xmasspos],[ymasspos],[zmasspos]])</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">;      Written by:    Jeremy Bailin</span>
<span class="comments">;      10 June 2008   Public release in JBIU</span>
<span class="comments">;      22 July 2011   Bug fix for /R2WEIGHT to actually do something useful</span>
<span class="comments">;-</span>
<a id="inertiatens:source"></a>function inertiatens, pos, masses=masses, r2weight=r2weight

Itens = dblarr(3,3)

npts = (size(pos,/dimen))[0]
weights = replicate(1.0,npts)
if keyword_set(r2weight) then begin
  posnot0 = where(total(pos^2,2) ne 0., nposnot0)
  if nposnot0 gt 0 then weights[posnot0] /= total(pos^2, 2)
endif
if n_elements(masses) ne 0 then weights *= masses

for i=0,2 do begin
  for j=i,2 do begin
    Itens[i,j] = total( weights * pos[*,i] * pos[*,j] )
    Itens[j,i] = Itens[i,j]
  endfor
endfor

return, Itens

end

</code>
    </div>
  </body>
</html>