<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.4 on Fri Jul 29 15:39:39 2016 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>match_sph.pro (Documentation for jbiu/)</title>

    

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="match_sph.pro (Documentation for jbiu/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for jbiu/</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="../overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="match_sph-code.html" title="Chromocoded source">Source</a> <a href="match_sph.pro" title=".pro file"><img src="../idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
        	<a href="../categories.html">Categories</a>
        </td>
    
        <td >
        	<a href="../search.html">Search</a>
        </td>
    
        
        <td >
          <a href="../idldoc-index.html">Index</a>
        </td>
        
    
        
        <td >
          <a href="../idldoc-warnings.html">Warnings</a>
        </td>
        
    
        <td >
          <a href="../idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          Developer documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="../index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">astro/</h2>
      <h1 class="basename">match_sph.pro<span class="file-attributes"></span></h1>
	    

      
      
	    
	    <br/>

      

      

      

      

      

      

              	
    	
    	<div id="routine-details">
    	  

        
        <div class="routine-details details" id="match_sph">
        	<h2 class="routine-name"><a href="#root" class="top">top</a> <a href="match_sph-code.html#match_sph:source" class="top">source</a> match_sph<span class="routine-attributes"></span></h2>
        	
        	
        	<p class="small categories">Astro</p>
        	
        	
          <p class="syntax"><code><span class="var">result</span> = match_sph(<span class="argument"><a href="#match_sph:p:ra1">ra1</a></span><span class="argument">, <a href="#match_sph:p:dec1">dec1</a></span><span class="argument">, <a href="#match_sph:p:ra2">ra2</a></span><span class="argument">, <a href="#match_sph:p:dec2">dec2</a></span><span class="argument">, <a href="#match_sph:p:sphrad">sphrad</a></span><span class="argument">, <a href="#match_sph:k:mindist">mindist</a>=<span class="var">mindist</span></span><span class="argument">, <a href="#match_sph:k:one_to_one">one_to_one</a>=<span class="var">one_to_one</span></span>)</code></p>

          
          <div class="small "><p>    For each angular point in one vector, determines the closest angular match
    from another vector. Method is to take the list returned by
    MATCHALL_SPH and narrow it down to the closest match.

</p>

</div>
          

          
          <h3>Return value</h3>
          	<div class="small"><p>    The function returns an array with one entry for each Ra1, Dec1
    element containing the index in Ra2, Dec2 that is closest, or -1 if
    there are none within Sphrad.

</p>

</div>
          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="match_sph:p:ra1">ra1 <span class="smaller">in </span></dt>
              <dd class="small"><p>    Vector of longitude coordinates, in degrees.

</p>

</dd>
              
              <dt id="match_sph:p:dec1">dec1 <span class="smaller">in </span></dt>
              <dd class="small"><p>   Vector of latitude coordinates, in degrees.

</p>

</dd>
              
              <dt id="match_sph:p:ra2">ra2 <span class="smaller">in </span></dt>
              <dd class="small"><p>    Vector of longitude coordinates, in degrees.

</p>

</dd>
              
              <dt id="match_sph:p:dec2">dec2 <span class="smaller">in </span></dt>
              <dd class="small"><p>   Vector of latitude coordinates, in degrees.

</p>

</dd>
              
              <dt id="match_sph:p:sphrad">sphrad <span class="smaller">in </span></dt>
              <dd class="small"><p> Maximum angular distance, in degrees. Matches outside
             of this radius are ignored.

</p>

</dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="match_sph:k:mindist">mindist <span class="smaller">in </span></dt>
              <dd class="small"><p> Optional output containing an array of the actual distance
               to the closest match for each element of Ra1, Dec1.

</p>

</dd>
              
              <dt id="match_sph:k:one_to_one">one_to_one <span class="smaller">in </span></dt>
              <dd class="small"><p> Enforces one-to-one matching. By default, matching can
                 be many-to-one, i.e. one entry in Ra2,Dec2 can be the
                 closest match to several entries in Ra1,Dec1. If
                 /ONE_TO_ONE is given, then each multiple entry in Ra2,Dec2
                 is first assigned to its closest point in Ra1,Dec1. Then any
                 entries in Ra1,Dec1 that have lost their match are assigned
                 the next closest point within Sphrad. This process is
                 iterated until all points in Ra1,Dec1 are matched to a
                 unique point in Ra2,Dec2 or there are no more points
                 within Sphrad

</p>

</dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><code class="listing">
    n1 = 25
    n2 = 10
    seed = 43L
    ra1 = randomn(seed, n1)
    dec1 = randomn(seed, n1)
    ra2 = randomn(seed, n2)
    dec2 = randomn(seed, n2)
    result1 = match_sph(ra1, dec1, ra2, dec2, 1.)
    result2 = match_sph(ra1, dec1, ra2, dec2, 1., /one_to_one)
    !p.multi=[0,2,1]
    plot, psym=1, ra1, dec1, xrange=[-3,3], yrange=[-3,3], title='Default'
    oplot, psym=4, ra2, dec2
    for i=0l,n1-1 do if result1[i] ne -1 then oplot, [ra1[i],ra2[result1[i]]], $
      [dec1[i],dec2[result1[i]]]
    plot, psym=1, ra1, dec1, xrange=[-3,3], yrange=[-3,3], title='/ONE_TO_ONE'
    oplot, psym=4, ra2, dec2
    for i=0l,n1-1 do if result2[i] ne -1 then oplot, [ra1[i],ra2[result2[i]]], $
      [dec1[i],dec2[result2[i]]]
</code></div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              

              

              
                <dt>History:</dt>
                <dd><p>    Written by:    Jeremy Bailin
    10 June 2008   Public release in JBIU as WITHINSPHRAD
    24 April 2009  Vectorized as WITHINSPHRAD_VEC
    25 April 2009  Polished to improve memory use
    9 May 2009     Radical efficiency re-write as WITHINSPHRAD_VEC3D borrowing
                   heavily from JD Smith's MATCH_2D
    13 May 2009    Removed * from LHS index in final remapping for speed
    23 August 2010 Modified to only return closest match as WITHINSPHRAD_CLOSEST
                   (importing some stuff back from MATCH_2D)
    8 Sept 2010    Renamed MATCH_SPH. Added /ONE_TO_ONE option, and modified
                   to explicitly call MATCHALL_SPH and then cull.
    13 April 2011  Fixed to work around cumulative total 1-element array bug.
</p>

</dd>
              

              
            </dl>
          

          

          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>
        	
        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue Aug  9 09:50:41 2011</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>174</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.4 on Fri Jul 29 15:39:39 2016</td>
          <td class="right"><a target="_top" href="http://idldoc.idldev.com">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>